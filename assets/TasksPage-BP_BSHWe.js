import{r as l,u as T,i as f,h as N,p as E,q as F,j as e,m as L,n as R,t as D,v as $,P as o,T as i,L as O,k as P}from"./index-krZ33pOX.js";import{F as G,T as v}from"./TaskForm-DlHnM7Bg.js";function I({title:s,titleId:a,...n},c){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":a},n),s?l.createElement("title",{id:a},s):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const M=l.forwardRef(I);function A({title:s,titleId:a,...n},c){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":a},n),s?l.createElement("title",{id:a},s):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const B=l.forwardRef(A);function H({title:s,titleId:a,...n},c){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":a},n),s?l.createElement("title",{id:a},s):null,l.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}const U=l.forwardRef(H),Q=({task:s})=>{const{user:a}=T(),{toggleTaskCompletion:n,deleteTask:c}=f(),{getGroupById:h,getDefaultGroup:y}=N(),[b,x]=l.useState(!1),[p,m]=l.useState(!1),{confirm:j,ConfirmComponent:r}=E(),{showToast:t}=F(),d=s.groupId?h(s.groupId):y(),u=g=>{switch(g){case o.URGENT:return"text-red-600 bg-red-100 border-red-200";case o.HIGH:return"text-orange-600 bg-orange-100 border-orange-200";case o.MEDIUM:return"text-yellow-600 bg-yellow-100 border-yellow-200";case o.LOW:return"text-green-600 bg-green-100 border-green-200";default:return"text-gray-600 bg-gray-100 border-gray-200"}},k=g=>{switch(g){case i.COMPLETED:return"text-green-600 bg-green-100";case i.IN_PROGRESS:return"text-blue-600 bg-blue-100";case i.TODO:return"text-gray-600 bg-gray-100";case i.CANCELLED:return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},w=s.dueDate&&s.dueDate<new Date&&!s.isCompleted,C=async()=>{if(a){x(!0);try{await n(a.uid,s.id,!s.isCompleted),t(s.isCompleted?"Đã đánh dấu task chưa hoàn thành":"Đã hoàn thành task!","success")}catch{t("Có lỗi xảy ra khi cập nhật task","error")}finally{x(!1)}}},S=()=>{a&&j("Xóa task",`Bạn có chắc chắn muốn xóa task "${s.title}"?`,async()=>{x(!0);try{await c(a.uid,s.id),t("Đã xóa task thành công","success")}catch{t("Có lỗi xảy ra khi xóa task","error")}finally{x(!1)}},"danger","Xóa task")};return e.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow border-l-4 p-6 ${s.isCompleted?"border-green-500":w?"border-red-500":"border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx("button",{onClick:C,disabled:b,className:"mt-1 text-gray-400 hover:text-green-600 transition-colors","aria-label":s.isCompleted?"Đánh dấu chưa hoàn thành":"Đánh dấu hoàn thành",children:s.isCompleted?e.jsx(U,{className:"w-6 h-6 text-green-600"}):e.jsx(L,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:`text-lg font-medium ${s.isCompleted?"text-gray-500 line-through":"text-gray-900 dark:text-white"}`,children:s.title}),s.description&&e.jsx("p",{className:`mt-1 text-sm ${s.isCompleted?"text-gray-400":"text-gray-600 dark:text-gray-300"}`,children:s.description}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${u(s.priority)}`,children:s.priority}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${k(s.status)}`,children:s.status.replace("-"," ")}),s.dueDate&&e.jsxs("div",{className:`flex items-center text-xs ${w?"text-red-600":"text-gray-500"}`,children:[w&&e.jsx(R,{className:"w-4 h-4 mr-1"}),e.jsx(G,{className:"w-4 h-4 mr-1"}),"Due: ",s.dueDate.toLocaleDateString()]}),d&&e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx("span",{className:"mr-1",children:d.icon}),e.jsx("span",{children:d.name})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:()=>m(!0),className:"text-gray-400 hover:text-blue-600 transition-colors","aria-label":"Chỉnh sửa task",children:e.jsx(D,{className:"w-5 h-5"})}),e.jsx("button",{onClick:S,disabled:b,className:"text-gray-400 hover:text-red-600 transition-colors","aria-label":"Xóa task",children:e.jsx($,{className:"w-5 h-5"})})]})]}),p&&e.jsx(v,{task:s,onClose:()=>m(!1),onSuccess:()=>{m(!1),t("Cập nhật task thành công","success")}}),e.jsx(r,{})]})},W=()=>e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow border-l-4 border-gray-300 p-6 animate-pulse",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-200 dark:bg-gray-700 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-5 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full mb-1"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-2/3 mb-3"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-full w-16"}),e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-full w-20"}),e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-full w-24"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"w-5 h-5 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"w-5 h-5 bg-gray-200 dark:bg-gray-700 rounded"})]})]})}),Z=({count:s=3})=>e.jsx("div",{className:"space-y-4",children:Array.from({length:s}).map((a,n)=>e.jsx(W,{},n))}),X=()=>{const{getFilteredTasks:s,loading:a}=f(),n=s();return a?e.jsx(Z,{count:5}):n.length===0?e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-8 text-center",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Không tìm thấy task nào. Tạo task đầu tiên để bắt đầu!"})}):e.jsx("div",{className:"space-y-4",children:n.map(c=>e.jsx(Q,{task:c},c.id))})},_=()=>{const{filters:s,setFilters:a}=f(),{fetchGroups:n}=N(),[c,h]=l.useState(s.searchQuery||"");l.useEffect(()=>{n()},[n]);const y=r=>{const t=s.status||[],d=t.includes(r)?t.filter(u=>u!==r):[...t,r];a({...s,status:d})},b=r=>{const t=s.priority||[],d=t.includes(r)?t.filter(u=>u!==r):[...t,r];a({...s,priority:d})},x=r=>{h(r),a({...s,searchQuery:r||void 0})},p=()=>{a({}),h("")},m=[{value:i.TODO,label:"To Do",color:"bg-gray-100 text-gray-800"},{value:i.IN_PROGRESS,label:"In Progress",color:"bg-blue-100 text-blue-800"},{value:i.COMPLETED,label:"Completed",color:"bg-green-100 text-green-800"},{value:i.CANCELLED,label:"Cancelled",color:"bg-red-100 text-red-800"}],j=[{value:o.LOW,label:"Low",color:"bg-green-100 text-green-800"},{value:o.MEDIUM,label:"Medium",color:"bg-yellow-100 text-yellow-800"},{value:o.HIGH,label:"High",color:"bg-orange-100 text-orange-800"},{value:o.URGENT,label:"Urgent",color:"bg-red-100 text-red-800"}];return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center",children:[e.jsx(M,{className:"w-5 h-5 mr-2"}),"Filters"]}),e.jsx("button",{onClick:p,className:"text-sm text-primary-600 hover:text-primary-700",children:"Clear all"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search tasks...",value:c,onChange:r=>x(r.target.value),className:"input-field pl-10"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Status"}),e.jsx("div",{className:"space-y-2",children:m.map(r=>{var t;return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((t=s.status)==null?void 0:t.includes(r.value))||!1,onChange:()=>y(r.value),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium ${r.color}`,children:r.label})]},r.value)})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Priority"}),e.jsx("div",{className:"space-y-2",children:j.map(r=>{var t;return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((t=s.priority)==null?void 0:t.includes(r.value))||!1,onChange:()=>b(r.value),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium ${r.color}`,children:r.label})]},r.value)})})]})]})},K=()=>{const{loading:s,fetchTasks:a}=f(),[n,c]=l.useState(!1);return l.useEffect(()=>{a()},[a]),s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(O,{size:"lg"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Tasks"}),e.jsxs("button",{onClick:()=>c(!0),className:"btn-primary flex items-center",children:[e.jsx(P,{className:"w-5 h-5 mr-2"}),"New Task"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(_,{})}),e.jsx("div",{className:"lg:col-span-3",children:e.jsx(X,{})})]}),n&&e.jsx(v,{onClose:()=>c(!1),onSuccess:()=>c(!1)})]})};export{K as default};

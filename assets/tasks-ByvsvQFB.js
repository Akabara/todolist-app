import{r as n,j as e,R as F,l as R,c as _,a as G,m as U,d as H,e as A,n as z,p as q,q as Q,k as W}from"./vendor-DYaN873j.js";import{a as C,u as L,c as P,T as x,P as g,M as B,b as V}from"./calendar-BBofz5px.js";import{u as I,L as S,a as k}from"./auth-B_ilVF6c.js";const X="modulepreload",K=function(t){return"/todolist-app/"+t},O={},J=function(a,l,u){let p=Promise.resolve();if(l&&l.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),c=d?.nonce||d?.getAttribute("nonce");p=Promise.allSettled(l.map(m=>{if(m=K(m),m in O)return;O[m]=!0;const y=m.endsWith(".css"),f=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${f}`))return;const s=document.createElement("link");if(s.rel=y?"stylesheet":X,y||(s.as="script"),s.crossOrigin="",s.href=m,c&&s.setAttribute("nonce",c),document.head.appendChild(s),y)return new Promise((o,h)=>{s.addEventListener("load",o),s.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${m}`)))})}))}function N(d){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=d,window.dispatchEvent(c),!c.defaultPrevented)throw d}return p.then(d=>{for(const c of d||[])c.status==="rejected"&&N(c.reason);return a().catch(N)})},M=({task:t,onClose:a,onSuccess:l})=>{const{user:u}=I(),{createTask:p,updateTask:N,refreshTasks:d}=C(),{groups:c,fetchGroups:m,getDefaultGroup:y}=L(),[f,s]=n.useState(!1),[o,h]=n.useState(""),{showToast:b}=P(),[i,T]=n.useState({title:t?.title||"",description:t?.description||"",startDate:t?.startDate?t.startDate.toISOString().split("T")[0]:new Date().toISOString().split("T")[0],dueDate:t?.dueDate?t.dueDate.toISOString().split("T")[0]:"",priority:t?.priority||g.MEDIUM,status:t?.status||x.TODO,groupId:t?.groupId||""});n.useEffect(()=>{c.length===0&&m()},[m,c.length]);const D=async r=>{if(r.preventDefault(),!u){h("User not authenticated");return}s(!0),h("");try{const v=y(),w={title:i.title.trim(),description:i.description.trim()||void 0,startDate:i.startDate?new Date(i.startDate):new Date,dueDate:i.dueDate?new Date(i.dueDate):void 0,priority:i.priority,status:i.status,groupId:i.groupId||v.id,isCompleted:i.status===x.COMPLETED,completedAt:i.status===x.COMPLETED?new Date:void 0};k("Task data prepared",w),t?(k("Updating existing task",t.id),await N(u.uid,t.id,w)):(k("Creating new task for user",u.uid),await p(u.uid,w)),k("Task operation completed successfully"),b(t?"C·∫≠p nh·∫≠t task th√†nh c√¥ng":"T·∫°o task th√†nh c√¥ng","success"),d(),l?.(),a()}catch(v){const w=v.message||"C√≥ l·ªói x·∫£y ra";h(w),b(w,"error")}finally{s(!1)}},j=(r,v)=>{T(w=>({...w,[r]:v}))};return e.jsx(B,{isOpen:!0,onClose:a,title:t?"Ch·ªânh s·ª≠a Task":"T·∫°o Task m·ªõi",className:"max-w-4xl",children:e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[o&&e.jsx("div",{className:"text-red-600 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded",children:o}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ti√™u ƒë·ªÅ *"}),e.jsx("input",{type:"text",required:!0,value:i.title,onChange:r=>j("title",r.target.value),className:"input-field",placeholder:"Nh·∫≠p ti√™u ƒë·ªÅ task",maxLength:200}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[i.title.length,"/200 k√Ω t·ª±"]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"M√¥ t·∫£"}),e.jsx("textarea",{value:i.description,onChange:r=>j("description",r.target.value),className:"input-field",rows:2,placeholder:"Nh·∫≠p m√¥ t·∫£ task",maxLength:1e3}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[i.description.length,"/1000 k√Ω t·ª±"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ng√†y b·∫Øt ƒë·∫ßu"}),e.jsx("input",{type:"date",value:i.startDate,onChange:r=>j("startDate",r.target.value),className:"input-field"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Ng√†y b·∫Øt ƒë·∫ßu th·ª±c hi·ªán"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"H·∫°n ho√†n th√†nh"}),e.jsx("input",{type:"date",value:i.dueDate,onChange:r=>j("dueDate",r.target.value),className:"input-field",min:i.startDate||void 0}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Ng√†y c·∫ßn ho√†n th√†nh"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"ƒê·ªô ∆∞u ti√™n"}),e.jsxs("select",{value:i.priority,onChange:r=>j("priority",r.target.value),className:"input-field",children:[e.jsx("option",{value:g.LOW,children:"üü¢ Th·∫•p"}),e.jsx("option",{value:g.MEDIUM,children:"üü° Trung b√¨nh"}),e.jsx("option",{value:g.HIGH,children:"üü† Cao"}),e.jsx("option",{value:g.URGENT,children:"üî¥ Kh·∫©n c·∫•p"})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"M·ª©c ƒë·ªô quan tr·ªçng"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tr·∫°ng th√°i"}),e.jsxs("select",{value:i.status,onChange:r=>j("status",r.target.value),className:"input-field",children:[e.jsx("option",{value:x.TODO,children:"üìù Ch∆∞a l√†m"}),e.jsx("option",{value:x.IN_PROGRESS,children:"‚ö° ƒêang l√†m"}),e.jsx("option",{value:x.COMPLETED,children:"‚úÖ Ho√†n th√†nh"}),e.jsx("option",{value:x.CANCELLED,children:"‚ùå ƒê√£ h·ªßy"})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"T√¨nh tr·∫°ng hi·ªán t·∫°i"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nh√≥m"}),e.jsxs("select",{value:i.groupId,onChange:r=>j("groupId",r.target.value),className:"input-field",children:[e.jsx("option",{value:"",children:"üìã Nh√≥m m·∫∑c ƒë·ªãnh"}),c.filter(r=>r.name!=="Default"&&r.name!=="Nh√≥m m·∫∑c ƒë·ªãnh").map(r=>e.jsxs("option",{value:r.id,children:[r.icon," ",r.name]},r.id))]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Ph√¢n lo·∫°i task theo nh√≥m"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",onClick:a,className:"btn-secondary",disabled:f,children:"H·ªßy"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:f||!i.title.trim(),children:f?e.jsx(S,{size:"sm"}):t?"C·∫≠p nh·∫≠t Task":"T·∫°o Task"})]})]})})},Y=Object.freeze(Object.defineProperty({__proto__:null,default:M},Symbol.toStringTag,{value:"Module"})),Z=t=>{switch(t){case g.URGENT:return"text-red-600 bg-red-100 border-red-200";case g.HIGH:return"text-orange-600 bg-orange-100 border-orange-200";case g.MEDIUM:return"text-yellow-600 bg-yellow-100 border-yellow-200";case g.LOW:return"text-green-600 bg-green-100 border-green-200";default:return"text-gray-600 bg-gray-100 border-gray-200"}},ee=t=>{switch(t){case x.COMPLETED:return"text-green-600 bg-green-100";case x.IN_PROGRESS:return"text-blue-600 bg-blue-100";case x.TODO:return"text-gray-600 bg-gray-100";case x.CANCELLED:return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},E=F.memo(({task:t})=>{const{user:a}=I(),{toggleTaskCompletion:l,deleteTask:u}=C(),{getGroupById:p,getDefaultGroup:N}=L(),[d,c]=n.useState(!1),[m,y]=n.useState(!1),{confirm:f,ConfirmComponent:s}=V(),{showToast:o}=P(),h=t.groupId?p(t.groupId):N(),b=n.useMemo(()=>t.dueDate&&t.dueDate<new Date&&!t.isCompleted,[t.dueDate,t.isCompleted]),i=n.useMemo(()=>Z(t.priority),[t.priority]),T=n.useMemo(()=>ee(t.status),[t.status]),D=n.useCallback(async()=>{if(!a)return;c(!0);const r=!t.isCompleted;console.log("üîÑ Toggling task completion:",{taskId:t.id,title:t.title,currentState:t.isCompleted,newState:r,isOverdue:b,dueDate:t.dueDate,status:t.status});try{await l(a.uid,t.id,r),o(t.isCompleted?"ƒê√£ ƒë√°nh d·∫•u task ch∆∞a ho√†n th√†nh":"ƒê√£ ho√†n th√†nh task!","success")}catch(v){console.error("‚ùå Error toggling task completion:",v),o(`C√≥ l·ªói x·∫£y ra: ${v.message}`,"error")}finally{c(!1)}},[a,t.id,t.title,t.isCompleted,b,t.dueDate,t.status,l,o]),j=n.useCallback(()=>{a&&f("X√≥a task",`B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a task "${t.title}"?`,async()=>{c(!0);try{await u(a.uid,t.id),o("ƒê√£ x√≥a task th√†nh c√¥ng","success")}catch{o("C√≥ l·ªói x·∫£y ra khi x√≥a task","error")}finally{c(!1)}},"danger","X√≥a task")},[a,t.id,t.title,f,u,o]);return e.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow border-l-4 p-6 ${t.isCompleted?"border-green-500":b?"border-red-500":"border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx("button",{onClick:D,disabled:d,className:"mt-1 text-gray-400 hover:text-green-600 transition-colors","aria-label":t.isCompleted?"ƒê√°nh d·∫•u ch∆∞a ho√†n th√†nh":"ƒê√°nh d·∫•u ho√†n th√†nh",children:t.isCompleted?e.jsx(R,{className:"w-6 h-6 text-green-600"}):e.jsx(_,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:`text-lg font-medium ${t.isCompleted?"text-gray-500 line-through":"text-gray-900 dark:text-white"}`,children:t.title}),t.description&&e.jsx("p",{className:`mt-1 text-sm ${t.isCompleted?"text-gray-400":"text-gray-600 dark:text-gray-300"}`,children:t.description}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${i}`,children:t.priority}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${T}`,children:t.status.replace("-"," ")}),t.dueDate&&e.jsxs("div",{className:`flex items-center text-xs ${b?"text-red-600":"text-gray-500"}`,children:[b&&e.jsx(G,{className:"w-4 h-4 mr-1"}),e.jsx(U,{className:"w-4 h-4 mr-1"}),"Due: ",t.dueDate.toLocaleDateString()]}),h&&e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx("span",{className:"mr-1",children:h.icon}),e.jsx("span",{children:h.name})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:()=>y(!0),className:"text-gray-400 hover:text-blue-600 transition-colors","aria-label":"Ch·ªânh s·ª≠a task",children:e.jsx(H,{className:"w-5 h-5"})}),e.jsx("button",{onClick:j,disabled:d,className:"text-gray-400 hover:text-red-600 transition-colors","aria-label":"X√≥a task",children:e.jsx(A,{className:"w-5 h-5"})})]})]}),m&&e.jsx(M,{task:t,onClose:()=>y(!1),onSuccess:()=>{y(!1),o("C·∫≠p nh·∫≠t task th√†nh c√¥ng","success")}}),e.jsx(s,{})]})}),$=n.memo(({tasks:t,className:a=""})=>t.length<=10?e.jsx("div",{className:`space-y-4 ${a}`,children:t.map(l=>e.jsx(E,{task:l},l.id))}):e.jsxs("div",{className:`space-y-4 ${a}`,children:[t.map(l=>e.jsx(E,{task:l},l.id)),!1]}));$.displayName="VirtualTaskList";const te=()=>e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow border-l-4 border-gray-300 p-6 animate-pulse",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-200 dark:bg-gray-700 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-5 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full mb-1"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-2/3 mb-3"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-full w-16"}),e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-full w-20"}),e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-full w-24"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"w-5 h-5 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"w-5 h-5 bg-gray-200 dark:bg-gray-700 rounded"})]})]})}),se=({count:t=3})=>e.jsx("div",{className:"space-y-4",children:Array.from({length:t}).map((a,l)=>e.jsx(te,{},l))}),ae=n.memo(()=>{const{getFilteredTasks:t,loading:a}=C(),l=t();return a?e.jsx(se,{count:5}):l.length===0?e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-8 text-center",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Kh√¥ng t√¨m th·∫•y task n√†o. T·∫°o task ƒë·∫ßu ti√™n ƒë·ªÉ b·∫Øt ƒë·∫ßu!"})}):l.length>20?e.jsx($,{tasks:l,height:600,itemSize:140,className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4"}):e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:e.jsx("div",{className:"space-y-4",children:l.map(u=>e.jsx(E,{task:u},u.id))})})}),re=n.memo(()=>{const{filters:t,setFilters:a}=C(),[l,u]=n.useState(t.searchQuery||""),p=n.useCallback(s=>{const o=t.status||[],h=o.includes(s)?o.filter(b=>b!==s):[...o,s];a({...t,status:h})},[t,a]),N=n.useCallback(s=>{const o=t.priority||[],h=o.includes(s)?o.filter(b=>b!==s):[...o,s];a({...t,priority:h})},[t,a]),d=n.useMemo(()=>z(s=>{a({...t,searchQuery:s||void 0})},300),[t,a]),c=n.useCallback(s=>{u(s),d(s)},[d]);n.useEffect(()=>()=>{d.cancel()},[d]);const m=n.useCallback(()=>{a({}),u("")},[a]),y=[{value:x.TODO,label:"To Do",color:"bg-gray-100 text-gray-800"},{value:x.IN_PROGRESS,label:"In Progress",color:"bg-blue-100 text-blue-800"},{value:x.COMPLETED,label:"Completed",color:"bg-green-100 text-green-800"},{value:x.CANCELLED,label:"Cancelled",color:"bg-red-100 text-red-800"}],f=[{value:g.LOW,label:"Low",color:"bg-green-100 text-green-800"},{value:g.MEDIUM,label:"Medium",color:"bg-yellow-100 text-yellow-800"},{value:g.HIGH,label:"High",color:"bg-orange-100 text-orange-800"},{value:g.URGENT,label:"Urgent",color:"bg-red-100 text-red-800"}];return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center",children:[e.jsx(q,{className:"w-5 h-5 mr-2"}),"Filters"]}),e.jsx("button",{onClick:m,className:"text-sm text-primary-600 hover:text-primary-700",children:"Clear all"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search tasks...",value:l,onChange:s=>c(s.target.value),className:"input-field pl-10"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Status"}),e.jsx("div",{className:"space-y-2",children:y.map(s=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.status?.includes(s.value)||!1,onChange:()=>p(s.value),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium ${s.color}`,children:s.label})]},s.value))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Priority"}),e.jsx("div",{className:"space-y-2",children:f.map(s=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.priority?.includes(s.value)||!1,onChange:()=>N(s.value),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium ${s.color}`,children:s.label})]},s.value))})]})]})}),le=n.lazy(()=>J(()=>Promise.resolve().then(()=>Y),void 0)),ne=()=>{const{loading:t,fetchTasks:a,cleanup:l}=C(),[u,p]=n.useState(!1);return n.useEffect(()=>(a(),()=>{l()}),[a,l]),t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(S,{size:"lg"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Tasks"}),e.jsxs("button",{onClick:()=>p(!0),className:"btn-primary flex items-center",children:[e.jsx(W,{className:"w-5 h-5 mr-2"}),"New Task"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(re,{})}),e.jsx("div",{className:"lg:col-span-3",children:e.jsx(ae,{})})]}),u&&e.jsx(n.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx(S,{size:"md"})}),children:e.jsx(le,{onClose:()=>p(!1),onSuccess:()=>p(!1)})})]})},de=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"}));export{M as T,J as _,Y as a,de as b};

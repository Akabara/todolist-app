import{r as n,j as e,z as j,A as p,k as y,c as g,m as N,a as b}from"./vendor-C0uaCzFa.js";import{a as w,T as h,D as k}from"./calendar-C0bcuvXa.js";import{d as v,g as D,u as T,L as S}from"./auth-Bq53jqvI.js";import{f as E,t as R,n as C,h as F,j as L}from"./firebase-vendor-CwXsO73q.js";import{T as P}from"./tasks-C7060Dwz.js";import"./state-vendor-C6akDs4E.js";class ${prefDocRef(t){return E(v,"users",t,"settings","preferences")}async getPreferences(t){const s=this.prefDocRef(t),a=await R(s);return a.exists()?a.data():null}subscribe(t,s){const a=this.prefDocRef(t);return C(a,d=>{if(!d.exists())return s(null);s(d.data())})}async setTheme(t,s){try{const a=this.prefDocRef(t);return await F(a,{theme:s,updatedAt:L()},{merge:!0}),{error:null}}catch(a){return{error:D(a)}}}}const u=new $,M=()=>{const[r,t]=n.useState(!1),{user:s}=T();n.useEffect(()=>{const d=document.documentElement,l=d.classList.contains("dark");if(t(l),!s)return;const i=u.subscribe(s.uid,x=>{const m=x?.theme;if(!m)return;const o=m==="dark";d.classList.toggle("dark",o),t(o);try{localStorage.setItem("theme",o?"dark":"light")}catch{}});return()=>{i&&i()}},[s]);const a=async()=>{const d=document.documentElement,l=!r;d.classList.toggle("dark",l),t(l);try{localStorage.setItem("theme",l?"dark":"light")}catch{}if(s)try{await u.setTheme(s.uid,l?"dark":"light")}catch{}};return e.jsx("button",{type:"button",onClick:a,"aria-pressed":r,title:r?"Switch to light mode":"Switch to dark mode",className:"inline-flex items-center justify-center rounded-lg border border-gray-300 dark:border-gray-600 p-2 text-gray-600 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500",children:r?e.jsx(j,{className:"w-5 h-5"}):e.jsx(p,{className:"w-5 h-5"})})},G=()=>{const{tasks:r,loading:t,fetchTasks:s}=w(),[a,d]=n.useState(!1),[l,i]=n.useState({total:0,completed:0,pending:0,overdue:0});return n.useEffect(()=>{s()},[s]),n.useEffect(()=>{const x=new Date,m=r.filter(c=>c.status===h.COMPLETED).length,o=r.filter(c=>c.status!==h.COMPLETED).length,f=r.filter(c=>c.dueDate&&c.dueDate<x&&c.status!==h.COMPLETED).length;i({total:r.length,completed:m,pending:o,overdue:f})},[r]),t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(S,{size:"lg"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Dashboard"}),e.jsxs("button",{onClick:()=>d(!0),className:"btn-primary flex items-center",children:[e.jsx(y,{className:"w-5 h-5 mr-2"}),"New Task"]})]}),e.jsx(M,{})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(g,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Tasks"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:l.total})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(g,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Completed"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:l.completed})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(N,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Pending"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:l.pending})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(b,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Overdue"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:l.overdue})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Calendar"})}),e.jsxs("div",{className:"p-6",children:[e.jsx(k,{tasks:r}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Double-click vào ngày để xem chi tiết công việc"})})]})]}),a&&e.jsx(P,{onClose:()=>d(!1),onSuccess:()=>d(!1)})]})};export{G as default};

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/tasks-ByvsvQFB.js","assets/vendor-DYaN873j.js","assets/calendar-BBofz5px.js","assets/state-vendor-CZdq9nfc.js","assets/firebase-vendor-DEp0eLQq.js","assets/auth-B_ilVF6c.js"])))=>i.map(i=>d[i]);
import{_ as j}from"./tasks-ByvsvQFB.js";import{r as d,j as e,C as k,D as N,k as b,c as f,m as w,a as v}from"./vendor-DYaN873j.js";import{a as D,T as x}from"./calendar-BBofz5px.js";import{d as T,g as E,u as S,L as g}from"./auth-B_ilVF6c.js";import{f as R,z as _,p as C,h as L,j as P}from"./firebase-vendor-DEp0eLQq.js";import"./state-vendor-CZdq9nfc.js";class F{prefDocRef(r){return R(T,"users",r,"settings","preferences")}async getPreferences(r){const t=this.prefDocRef(r),a=await _(t);return a.exists()?a.data():null}subscribe(r,t){const a=this.prefDocRef(r);return C(a,c=>{if(!c.exists())return t(null);t(c.data())})}async setTheme(r,t){try{const a=this.prefDocRef(r);return await L(a,{theme:t,updatedAt:P()},{merge:!0}),{error:null}}catch(a){return{error:E(a)}}}}const u=new F,z=()=>{const[s,r]=d.useState(!1),{user:t}=S();d.useEffect(()=>{const c=document.documentElement,l=c.classList.contains("dark");if(r(l),!!t)try{const n=u.subscribe(t.uid,h=>{const o=h?.theme;if(!o)return;const i=o==="dark";c.classList.toggle("dark",i),r(i);try{localStorage.setItem("theme",i?"dark":"light")}catch{}});return()=>{n&&n()}}catch{u.getPreferences(t.uid).then(h=>{const o=h?.theme;if(!o)return;const i=o==="dark";c.classList.toggle("dark",i),r(i);try{localStorage.setItem("theme",i?"dark":"light")}catch{}}).catch(()=>{})}},[t]);const a=async()=>{const c=document.documentElement,l=!s;c.classList.toggle("dark",l),r(l);try{localStorage.setItem("theme",l?"dark":"light")}catch{}if(t)try{await u.setTheme(t.uid,l?"dark":"light")}catch{}};return e.jsx("button",{type:"button",onClick:a,"aria-pressed":s,title:s?"Switch to light mode":"Switch to dark mode",className:"inline-flex items-center justify-center rounded-lg border border-gray-300 dark:border-gray-600 p-2 text-gray-600 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500",children:s?e.jsx(k,{className:"w-5 h-5"}):e.jsx(N,{className:"w-5 h-5"})})},I=d.lazy(()=>j(()=>import("./tasks-ByvsvQFB.js").then(s=>s.a),__vite__mapDeps([0,1,2,3,4,5]))),O=d.lazy(()=>j(()=>import("./calendar-BBofz5px.js").then(s=>s.D),__vite__mapDeps([2,1,3,4,5,0]))),G=()=>{const{tasks:s,loading:r,fetchTasks:t,cleanup:a}=D(),[c,l]=d.useState(!1),[n,h]=d.useState({total:0,completed:0,pending:0,overdue:0});return d.useEffect(()=>(t(),()=>{a()}),[t,a]),d.useEffect(()=>{const o=new Date,i=s.filter(m=>m.status===x.COMPLETED).length,p=s.filter(m=>m.status!==x.COMPLETED).length,y=s.filter(m=>m.dueDate&&m.dueDate<o&&m.status!==x.COMPLETED).length;h({total:s.length,completed:i,pending:p,overdue:y})},[s]),r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(g,{size:"lg"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Dashboard"}),e.jsxs("button",{onClick:()=>l(!0),className:"btn-primary flex items-center",children:[e.jsx(b,{className:"w-5 h-5 mr-2"}),"New Task"]})]}),e.jsx(z,{})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(f,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Tasks"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:n.total})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(f,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Completed"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:n.completed})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(w,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Pending"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:n.pending})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(v,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Overdue"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:n.overdue})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Calendar"})}),e.jsxs("div",{className:"p-6",children:[e.jsx(d.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(g,{size:"lg"})}),children:e.jsx(O,{tasks:s})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Double-click vào ngày để xem chi tiết công việc"})})]})]}),c&&e.jsx(d.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx(g,{size:"md"})}),children:e.jsx(I,{onClose:()=>l(!1),onSuccess:()=>l(!1)})})]})};export{G as default};
